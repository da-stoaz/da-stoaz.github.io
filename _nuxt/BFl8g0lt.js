import{l as A,r as O,x as C,D as S,u as E,n as b}from"./DqA0wvgn.js";import{u as w,s as z}from"./BAj6X1XV.js";import{u as x}from"./BPKLwf0D.js";import{u as f}from"./CWY8yeRe.js";const F=A("trainer",()=>{const d=E(),r=w(),m=x(),u=O([]),o=C();S(()=>{r.user.isAuthenticated&&c()});async function c(){var t,s,i;if(!r.user.isAuthenticated)return!1;const{data:e,error:a}=await f(`${d.public.apiBase}/trainers`,{server:!1,method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r.user.token}`}},"$DOWdF7NQQT");if((t=a.value)!=null&&t.statusCode){if(((s=a.value)==null?void 0:s.statusCode)===401){r.user.isAuthenticated=!1;return}return o.add({severity:"error",summary:"Error",detail:(i=a.value)==null?void 0:i.message,life:3e3}),console.error(a.value),null}return u.value=e.value?e.value:[],u.value}async function p(e){var i,n;if(!r.user.isAuthenticated)return!1;const{data:a,status:t,error:s}=await f(`${d.public.apiBase}/trainer`,{server:!1,method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r.user.token}`},body:{firstname:e.firstname,lastname:e.lastname,dateOfBirth:e.dateOfBirth?new Date(e.dateOfBirth).toISOString().substring(0,10):null,placeOfBirth:e.placeOfBirth,street:e.street,house:e.house,plz:e.plz,place:e.place,mail:e.mail,phone:e.phone}},"$KK6dLOSdPo");if(s.value){if(((i=s.value)==null?void 0:i.statusCode)===401){r.user.isAuthenticated=!1;return}o.add({severity:"error",summary:"Error",detail:s.value.message,life:3e3}),console.error(s.value);return}if(t.value==="success"&&((n=a.value)!=null&&n.ID)){const l={...e,userId:a.value.ID};return u.value.push(l),o.add({severity:"success",summary:"Erfolgreich",detail:"Trainer erfolgreich erstellt",life:3e3}),l}}async function y(e){var s,i,n;if(!r.user.isAuthenticated)return!1;const{data:a,error:t}=await f(`${d.public.apiBase}/trainer/${e.userId}`,{server:!1,method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r.user.token}`},body:{firstname:e.firstname,lastname:e.lastname,dateOfBirth:e.dateOfBirth?new Date(e.dateOfBirth).toISOString().substring(0,10):null,placeOfBirth:e.placeOfBirth,street:e.street,house:e.house,plz:e.plz,place:e.place,mail:e.mail,phone:e.phone}},"$BRBRrT65OW");if(t.value){if(((s=t.value)==null?void 0:s.statusCode)===401){r.user.isAuthenticated=!1;return}return o.add({severity:"error",summary:"Error",detail:t.value.message,life:3e3}),console.error(t.value),null}if(((i=a.value)==null?void 0:i.status)==="success"){const l=(n=u.value)==null?void 0:n.findIndex(v=>v.userId===e.userId);l!==-1&&(u.value[l]={...u.value[l],...e}),o.add({severity:"success",summary:"Erfolgreich",detail:"Trainer erfolgreich aktualisiert",life:3e3})}return u.value}async function T(e){var s,i,n;if(!r.user.isAuthenticated||!r.user.isAdmin)return!1;const{data:a,error:t}=await f(`${d.public.apiBase}/trainer/${e}`,{server:!1,method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r.user.token}`}},"$x_nK95H0LH");if(t.value){if(((s=t.value)==null?void 0:s.statusCode)===4018){r.user.isAuthenticated=!1;return}return o.add({severity:"error",summary:"Error",detail:t.value.message,life:3e3}),console.error(t.value),null}((i=a.value)==null?void 0:i.status)==="success"&&o.add({severity:"success",summary:"Erfolgreich",detail:"Trainer erfolgreich gelÃ¶scht",life:3e3}),u.value=(n=u.value)==null?void 0:n.filter(l=>l.userId!==e)}function B(e){var a;return(a=u.value)==null?void 0:a.find(t=>t.userId===e)}function $(e){var t;const a=(t=u.value)==null?void 0:t.find(s=>s.userId===e);return`${a==null?void 0:a.firstname} ${a==null?void 0:a.lastname}`}async function g(e){var i,n;if(!r.user.isAuthenticated)return!1;const{data:a,status:t,error:s}=await f(`${d.public.apiBase}/trainer/${e}`,{server:!1,method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r.user.token}`}},"$xlSHzDvv2T");if(((i=s.value)==null?void 0:i.statusCode)===401&&(r.user.isAuthenticated=!1),s.value){o.add({severity:"error",summary:"Fehler",detail:"Trainer konnte nicht geladen werden",life:3e3}),console.error(s.value);return}if(t.value==="success"&&a.value){const l=(n=u.value)==null?void 0:n.findIndex(v=>{var h;return v.userId===((h=a.value)==null?void 0:h.userId)});return l!==-1?u.value[l]={...u.value[l],...a.value}:u.value.push(a.value),a.value}}const I=b(()=>{var e;return(e=u.value)==null?void 0:e.map(a=>({label:`${a.firstname} ${a.lastname}`,value:a.userId}))});return z(c,m.updateInterval*1e3),{trainers:u,fetchTrainers:c,addTrainer:p,updateTrainer:y,deleteTrainer:T,getTrainerById:g,trainerById:B,trainerNameById:$,mappedTrainers:I}});export{F as u};
