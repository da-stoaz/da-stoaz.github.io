import{_ as R}from"./JPTxK4B8.js";import{_ as Z,u as I,a as H}from"./Dt7LU2GS.js";import j from"./CBwK3qgQ.js";import{l as q,m as G,r as E,d as P,n as A,q as J,j as p,o as u,w as l,g as r,a as n,e as D,i as S,s as B,c as O,F as K,h as Q,t as X,f as y,v as Y,x as ee}from"./DqA0wvgn.js";import C from"./CJU-G3S3.js";import L from"./Dq60U7H_.js";import{c as te}from"./iBF5vbor.js";import{u as M}from"./D54JuXSh.js";import oe from"./I8Cde3Md.js";import{u as W}from"./BAj6X1XV.js";import{u as se}from"./BFl8g0lt.js";import re from"./DmjlN0hB.js";import ne from"./BHQrEIPo.js";import ae from"./CgOSnCR7.js";import ie from"./BDzyn8ai.js";import le from"./XuQxJhds.js";import{u as me}from"./DlM3upmM.js";import"./CGmoPu9p.js";import"./xJh7gdIs.js";import"./CIEVKKL1.js";import"./CrqMR_Gz.js";import"./B3N0Dfa_.js";import"./X7vmODOq.js";import"./CbAtA9qB.js";import"./Fiz1UT9X.js";import"./DwqQTTJx.js";import"./D59xopTu.js";import"./BPKLwf0D.js";import"./CWY8yeRe.js";import"./Dwe5DX2x.js";import"./92YlIw8Z.js";import"./Vjg67_ig.js";import"./Dq2NiRLV.js";import"./BnCsyjQa.js";const U=q("bookingForm",()=>{const F={date:"",startTime:"",endTime:"",fieldArray:[],trainer:null,team:"",recurring:""},f=G({...F}),v=E(0);function s(a){Object.assign(f,a)}function m(a){f.fieldArray=a}function x(a){Object.assign(f,a)}function _(){Object.assign(f,F),v.value++}return{formData:f,formVersion:v,updateDateTime:s,updateFields:m,updateDetails:x,resetForm:_}}),ue={class:"flex flex-col lg:flex-row justify-center gap-4 lg:gap-8"},de={class:"flex flex-col lg:w-6/12 gap-2"},ce={class:"flex flex-col"},pe={class:"flex flex-col lg:w-6/12 gap-2"},fe={class:"flex flex-col w-full gap-4"},ve={class:"flex flex-col gap-2"},_e={class:"flex flex-col w-full"},ge={class:"flex pt-6 justify-end"},be=P({__name:"EventDateTimeSelect",emits:["next"],setup(F,{emit:f}){const v=f,s=U(),m=M(),x=A({get:()=>s.formData.date,set:e=>s.updateDateTime({date:e,startTime:s.formData.startTime,endTime:s.formData.endTime})}),_=A({get:()=>s.formData.startTime,set:e=>s.updateDateTime({date:s.formData.date,startTime:e,endTime:s.formData.endTime})}),a=A({get:()=>s.formData.endTime,set:e=>s.updateDateTime({date:s.formData.date,startTime:s.formData.startTime,endTime:e})}),o=E(m.times.slice(0,-1)||[]),i=E(m.times.slice(1)||[]);J(()=>_.value,e=>{e?i.value=m.times.filter(t=>te(t,e)>0):i.value=[]});const k=async({valid:e})=>{e&&(s.updateDateTime({date:x.value,startTime:_.value,endTime:a.value}),v("next"))},d=({values:e})=>{const t={};return e.date||(t.date=[{message:"Datum ist erforderlich"}]),e.startTime||(t.startTime=[{message:"Startzeit ist erforderlich"}]),e.endTime||(t.endTime=[{message:"Endzeit ist erforderlich"}]),{errors:Object.keys(t).length?t:null}};return(e,t)=>{const h=Z,c=L,g=C,w=B,V=j;return u(),p(V,{resolver:d,onSubmit:k},{default:l($=>{var b,T,N;return[r("div",ue,[r("div",de,[t[4]||(t[4]=r("h3",{class:"text-xl font-bold"},"Datum Wählen",-1)),r("div",ce,[n(h,{name:"date","min-date":new Date,isoDateString:x.value,"onUpdate:isoDateString":t[0]||(t[0]=z=>x.value=z),inline:""},null,8,["min-date","isoDateString"]),(b=$.date)!=null&&b.invalid?(u(),p(c,{key:0,severity:"error",size:"small",variant:"simple"},{default:l(()=>t[3]||(t[3]=[S(" Datum erforderlich! ")])),_:1})):D("",!0)])]),r("div",pe,[t[9]||(t[9]=r("h3",{class:"text-xl font-bold"},"Zeit Wählen",-1)),r("div",fe,[r("div",ve,[t[6]||(t[6]=r("label",{for:"startTime",class:"font-semibold"},"Startzeitpunkt",-1)),n(g,{options:o.value,name:"startTime",placeholder:"Startzeitpunkt auswählen",modelValue:_.value,"onUpdate:modelValue":t[1]||(t[1]=z=>_.value=z),class:"min-w-56 w-full"},null,8,["options","modelValue"]),(T=$.startTime)!=null&&T.invalid?(u(),p(c,{key:0,severity:"error",size:"small",variant:"simple"},{default:l(()=>t[5]||(t[5]=[S(" Startzeit ist erforderlich! ")])),_:1})):D("",!0)]),r("div",_e,[t[8]||(t[8]=r("label",{for:"endTime",class:"font-semibold"},"Endzeitpunkt",-1)),n(g,{name:"endTime",modelValue:a.value,"onUpdate:modelValue":t[2]||(t[2]=z=>a.value=z),disabled:!_.value,placeholder:"Endzeitpunkt auswählen",options:i.value,class:"min-w-56 w-full"},null,8,["modelValue","disabled","options"]),(N=$.endTime)!=null&&N.invalid?(u(),p(c,{key:0,severity:"error",size:"small",variant:"simple"},{default:l(()=>t[7]||(t[7]=[S(" Endzeit ist erforderlich! ")])),_:1})):D("",!0)])])])]),r("div",ge,[n(w,{label:"Weiter",icon:"pi pi-arrow-right",iconPos:"right",type:"submit"})])]}),_:1})}}}),Te=Object.assign(be,{__name:"EventDateTimeSelect"}),xe={class:"flex flex-col gap-2"},ye={class:"flex flex-col md:flex-row w-full gap-2"},Se={class:"flex pt-6 justify-between"},he=P({__name:"EventFields",emits:["next","previous"],setup(F,{emit:f}){const v=f,s=U(),m=E([!1,!1,!1]),x=async({valid:a})=>{if(!a)return;const o=m.value.map((i,k)=>i?`field${k+1}`:"").filter(Boolean);s.updateFields(o),v("next")},_=()=>{const a={};return m.value.includes(!0)||(a.fieldArray=[{message:"Mindestens ein Platz muss ausgewählt werden"}]),{errors:Object.keys(a).length?a:null}};return(a,o)=>{const i=oe,k=L,d=B,e=j;return u(),p(e,{resolver:_,onSubmit:x},{default:l(t=>{var h;return[r("div",xe,[o[1]||(o[1]=r("h3",{class:"text-xl font-bold"},"Plätze Auswählen",-1)),r("div",ye,[(u(!0),O(K,null,Q(m.value,(c,g)=>(u(),p(i,{key:g,modelValue:m.value[g],"onUpdate:modelValue":w=>m.value[g]=w,onLabel:`Platz ${g+1}`,offLabel:`Platz ${g+1}`,onIcon:"pi pi-check",class:"flex-grow",name:`fieldArray-${g}`},null,8,["modelValue","onUpdate:modelValue","onLabel","offLabel","name"]))),128))]),(h=t.fieldArray)!=null&&h.invalid?(u(),p(k,{key:0,severity:"error",size:"small",variant:"simple"},{default:l(()=>{var c;return[S(X((c=t.fieldArray.error)==null?void 0:c.message),1)]}),_:2},1024)):D("",!0)]),r("div",Se,[n(d,{label:"Zurück",severity:"secondary",icon:"pi pi-arrow-left",onClick:o[0]||(o[0]=c=>a.$emit("previous"))}),n(d,{label:"Weiter",icon:"pi pi-arrow-right",iconPos:"right",type:"submit"})])]}),_:1})}}}),ke=Object.assign(he,{__name:"EventFields"}),we={class:"flex flex-col gap-2"},De={key:0,class:"flex flex-col gap-2"},$e={class:"flex flex-col gap-2"},Fe={class:"flex flex-col gap-2"},Ve={class:"flex pt-6 justify-between"},ze={class:"flex flex-col gap-2 mt-4"},Ee=P({__name:"EventDetails",emits:["previous","submit"],setup(F,{emit:f}){const v=f,s=U(),m=W(),x=M(),_=I(),a=se(),o=A({get:()=>({trainer:s.formData.trainer,team:s.formData.team,recurring:s.formData.recurring}),set:d=>s.updateDetails(d)}),i=({values:d})=>{const e={};return d.trainer||(e.trainer=[{message:"Trainer ist erforderlich"}]),d.team||(e.team=[{message:"Team ist erforderlich"}]),d.recurring||(e.recurring=[{message:"Wiederholung ist erforderlich"}]),{errors:Object.keys(e).length?e:null}},k=async({valid:d})=>{d&&(s.updateDetails(o.value),v("submit"))};return(d,e)=>{const t=C,h=L,c=B,g=j;return u(),p(g,{resolver:i,onSubmit:k},{default:l(w=>{var V,$,b;return[r("div",we,[e[10]||(e[10]=r("h3",{class:"text-xl font-bold"},"Buchungsdetails",-1)),y(m).user.isAdmin?(u(),O("div",De,[e[5]||(e[5]=r("label",{for:"trainer",class:"font-semibold"},"Trainer Auswählen",-1)),y(m).user.isAdmin?(u(),p(t,{key:0,name:"trainer",id:"trainer",modelValue:y(o).trainer,"onUpdate:modelValue":e[0]||(e[0]=T=>y(o).trainer=T),options:y(a).mappedTrainers,optionLabel:"label","option-value":"value",placeholder:"Trainer auswählen",checkmark:"",highlightOnSelect:!1,class:"w-full"},null,8,["modelValue","options"])):D("",!0),(V=w.trainer)!=null&&V.invalid?(u(),p(h,{key:1,severity:"error",size:"small",variant:"simple"},{default:l(()=>e[4]||(e[4]=[S("Auswahl Erforderlich!")])),_:1})):D("",!0)])):D("",!0),r("div",$e,[e[7]||(e[7]=r("label",{for:"teams",class:"font-semibold"},"Team Auswählen",-1)),n(t,{id:"teams",name:"team",modelValue:y(o).team,"onUpdate:modelValue":e[1]||(e[1]=T=>y(o).team=T),options:y(_).mappedTeams,optionLabel:"label","option-value":"value",placeholder:"Team auswählen",checkmark:"",highlightOnSelect:!1,class:"w-full"},null,8,["modelValue","options"]),($=w.team)!=null&&$.invalid?(u(),p(h,{key:0,severity:"error",size:"small",variant:"simple"},{default:l(()=>e[6]||(e[6]=[S("Auswahl Erforderlich!")])),_:1})):D("",!0)]),r("div",Fe,[e[9]||(e[9]=r("label",{for:"teams",class:"font-semibold"},"Wiederholung",-1)),n(t,{modelValue:y(o).recurring,"onUpdate:modelValue":e[2]||(e[2]=T=>y(o).recurring=T),name:"recurring",options:y(x).recurringOptions,optionLabel:"label","option-value":"value",placeholder:"Wiederholung",checkmark:"",highlightOnSelect:!1,class:"w-full"},null,8,["modelValue","options"]),(b=w.recurring)!=null&&b.invalid?(u(),p(h,{key:0,severity:"error",size:"small",variant:"simple"},{default:l(()=>e[8]||(e[8]=[S("Auswahl Erforderlich!")])),_:1})):D("",!0)])]),r("div",Ve,[n(c,{label:"Zurück",severity:"secondary",icon:"pi pi-arrow-left",onClick:e[3]||(e[3]=T=>d.$emit("previous"))})]),r("div",ze,[n(c,{type:"submit"},{default:l(()=>e[11]||(e[11]=[S("Buchung Abschließen")])),_:1})])]}),_:1})}}}),Ae=Object.assign(Ee,{__name:"EventDetails"}),Pe={class:"container"},ft=P({__name:"booking",setup(F){me({title:"Platzbuchung | USC Maria Taferl",htmlAttrs:{lang:"de"},meta:[{name:"description",content:"Buchen Sie als Trainer einen Platz des USC Maria Taferl"},{name:"keywords",content:"Maria Taferl, Fußball Maria Taferl, USC Maria Taferl"},{name:"author",content:"USC Maria Taferl"}]});const f=Y(),v=W(),s=M(),m=U();ee(),v.setRedirectRoute(f.currentRoute.value.fullPath);const x=E(!1),_=async()=>{x.value=!0;const o=m.formData;v.user.isAdmin||(o.trainer=v.user.trainerId);const i=await s.addEvent({date:o.date,startTime:o.startTime,endTime:o.endTime,fieldArray:o.fieldArray,team:o.team,trainer:o.trainer,recurring:o.recurring});return i&&m.resetForm(),x.value=!1,i},a=async o=>{await _()&&o("1")};return(o,i)=>{const k=R,d=H,e=le,t=ie,h=Te,c=ae,g=ke,w=Ae,V=ne,$=re;return u(),O("div",Pe,[n(k,{title:"Platzreservierung",hLevel:1}),y(v).user.isAuthenticated?(u(),p($,{key:1,value:"1",linear:"",class:"dark:!bg-surface-800 rounded-lg overflow-hidden"},{default:l(()=>[n(t,{class:"border-b bg-surface-100 dark:bg-surface-800"},{default:l(()=>[n(e,{value:"1"},{default:l(()=>i[0]||(i[0]=[S("Zeit & Datum")])),_:1}),n(e,{value:"2"},{default:l(()=>i[1]||(i[1]=[S("Plätze")])),_:1}),n(e,{value:"3"},{default:l(()=>i[2]||(i[2]=[S("Buchungsdetails")])),_:1})]),_:1}),n(V,{class:"dark:!bg-surface-900 md:!p-4"},{default:l(()=>[n(c,{value:"1"},{default:l(({activateCallback:b})=>[n(h,{onNext:T=>b("2")},null,8,["onNext"])]),_:1}),n(c,{value:"2"},{default:l(({activateCallback:b})=>[n(g,{onNext:T=>b("3"),onPrevious:T=>b("1")},null,8,["onNext","onPrevious"])]),_:1}),n(c,{value:"3"},{default:l(({activateCallback:b})=>[n(w,{onPrevious:T=>b("2"),onSubmit:()=>a(b)},null,8,["onPrevious","onSubmit"])]),_:1})]),_:1})]),_:1})):(u(),p(d,{key:0}))])}}});export{ft as default};
